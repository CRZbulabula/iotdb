# 开发文档
这里是 iotdbctl 的开发文档。

## 开发环境
IoTDB集群管理工具需要python3.8及以上版本

## 文件说明
main.py: 主函数，用于检测外界输入并分发给文件夹内的文件处理。其中，除 iotdbctl 外，第一参数是文件夹名，
第二参数是文件名。如
iotdbctl cluster clean <cluster name>， 将会调用 cluster 文件夹里的 clean.py。

config： 用于存放 yaml 文件，其中保存了 yaml 文件的默认格式。

tools： 用于存放执行文件用到的工具类。

wheels: 用于存放项目依赖的库的对应 whl 文件。目前每个库只支持放一个whl文件。

logs: 存放部署工具日志，如果想要查看部署工具执行日志请查看`logs/iotd.log`。

在每一个存放执行文件的文件夹中（如cluster），都有 preCheck、undo、preTreatment 三个文件夹。这三个文件夹每个命令的同名文件，分别用于每个命令的预检查、预处理和撤销。
一个命令在预检查和预处理后才会写入日志，而当用户输入undo时，将会调用 undo 中的同名文件来对对应命令进行撤销。当这三个文件夹中的文件执行成功时，应当退出并返回返回值0，
执行失败时，应当退出并返回非0值。

undo 中的文件应该保证，对一个成功执行和失败执行的文件，都可以完整撤销。而一个命令本身应该保证，它在上一次失败执行或还未执行时，都应该达到正确的执行效果。

目前，wal 日志及 undo、redo、clean 等功能均暂时禁用，等待各指令的 undo 功能开发完成。


## 格式说明
在写完一个文件后，应当在命令行内执行：
```bash
black 文件名.py
```
以使用 python 中的 black 模块格式化代码。如果要对文件夹内的所有文件进行格式化，可以在文件夹目录下执行：
```bash
black *
```
